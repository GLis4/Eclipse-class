package desafios;

import java.util.Scanner;
import java.sql.*;

public class CadastroXepaDB {
	static Scanner sc = new Scanner(System.in);
	private Connection conn;
	private Statement stm;
	
	public CadastroXepaDB(String arquivo) throws SQLException, ClassNotFoundException {
		Class.forName("org.sqlite.JDBC");

		this.conn = DriverManager.getConnection("jdbc:sqlite:" + arquivo);
		this.stm = this.conn.createStatement();
	}


	public void criarTabela() throws SQLException {
		this.stm.executeUpdate("CREATE TABLE parceiro ("
				+ "nome varchar(70) PRIMARY KEY NOT NULL);");
	}


	public void insert(String nome) {		  
		try {		  
			this.stm = this.conn.createStatement();

			this.stm.executeUpdate("INSERT INTO parceiro VALUES ('"+ nome + "')");
		}
		catch (SQLException e) {
			e.printStackTrace();
		}
	}


	public void showAll() {
		System.out.println("Mostrando dados");

		ResultSet rs;

		try {
			rs = this.stm.executeQuery("SELECT * FROM parceiro");

			while (rs.next()) {
				System.out.println(rs.getString("nome"));
			}

			rs.close();

		}
		catch (SQLException e) {
			e.printStackTrace();
		}
	
}
